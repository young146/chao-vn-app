# í”„ë¡œì íŠ¸ ì¸ê³„ ë° í˜„ì¬ ìƒíƒœ ëª…ì„¸ì„œ (Handover Notes)

ë³¸ ë¬¸ì„œëŠ” ì•±ì˜ ì£¼ìš” ê¸°ëŠ¥ ê°œì„  ì‚¬í•­ê³¼ í˜„ì¬ í•´ê²° ì¤‘ì¸ êµ¬ê¸€ ë¡œê·¸ì¸ ì´ìŠˆì˜ ìƒì„¸ ê³¼ì •ì„ ê¸°ë¡í•œ ë¬¸ì„œì…ë‹ˆë‹¤. ë‹¤ìŒ ì‘ì—…ìê°€ í˜„ì¬ì˜ ë§¥ë½ì„ ì¦‰ì‹œ íŒŒì•…í•˜ê³  ì´ì–´ì„œ ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

## 1. ìµœê·¼ ì™„ë£Œëœ ì£¼ìš” ê°œì„  ì‚¬í•­ (ì„±ê³µ ì‚¬ë¡€)

### 1.1 ì´ˆê¸° ë¡œë”© ì†ë„ ìµœì í™” (0ì´ˆ ë¡œë”© êµ¬í˜„)
- **ë°°ê²½:** ë‹¹ê·¼ ë©”ë‰´ ì§„ì… ì‹œ ë°ì´í„° ë¡œë”©ì— 15ì´ˆ ì´ìƒ ì†Œìš”ë˜ì–´ ì‚¬ìš©ì ì´íƒˆ ìœ„í—˜ì´ ì»¸ìŒ.
- **ì¡°ì¹˜:** 
    - `App.js`ì—ì„œ ì•± ì‹¤í–‰ ì¦‰ì‹œ ë°°ê²½ì—ì„œ ë‹¹ê·¼ ë°ì´í„°ì™€ ìƒìœ„ 6ê°œ ì´ë¯¸ì§€ë¥¼ í”„ë¦¬í˜ì¹˜(Prefetch)í•˜ì—¬ `AsyncStorage` ë° ì´ë¯¸ì§€ ìºì‹œì— ì €ì¥.
    - `XinChaoDanggnScreen.js`ì—ì„œ ì„œë²„ ë°ì´í„°ë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ìºì‹œ ë°ì´í„°ë¥¼ ì¦‰ì‹œ í‘œì‹œí•˜ë„ë¡ ìˆ˜ì •.
- **ê²°ê³¼:** ë©”ë‰´ ì§„ì… ì‹œ ì²´ê° ë¡œë”© ì†ë„ 0ì´ˆ ë‹¬ì„±.

### 1.2 ì±„íŒ… ì„±ëŠ¥ ë° ë¦¬ìŠ¤íŠ¸ ìµœì í™”
- **ì±„íŒ…ë°© ëª©ë¡:** í”„ë¦¬í˜ì¹˜ ë¡œì§ì„ ì ìš©í•˜ê³ , ì¤‘ë³µ í‚¤ ì—ëŸ¬ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ `Map` ê°ì²´ë¥¼ ì´ìš©í•œ ìœ ë‹ˆí¬ í•„í„°ë§ ì ìš©.
- **ë©”ì‹œì§€ ë¡œë”©:** `limitToLast(50)`ì„ ì ìš©í•˜ì—¬ ìµœì‹  ë©”ì‹œì§€ ìœ„ì£¼ë¡œ ë¡œë”© ì†ë„ ê°œì„ .
- **ì¤‘ë³µ ì—ëŸ¬ í•´ê²°:** `FlatList`ì—ì„œ ë°œìƒí•˜ë˜ `Encountered two children with the same key` ì—ëŸ¬ë¥¼ ëª¨ë“  ì£¼ìš” ë¦¬ìŠ¤íŠ¸(ë‹¹ê·¼, ì±„íŒ…ëª©ë¡)ì—ì„œ ë¡œì§ì ìœ¼ë¡œ ì°¨ë‹¨í•¨.

### 1.3 ë°ì´í„° í•„í„°ë§ ë° ì¸ë±ìŠ¤ ì—ëŸ¬ ëŒ€ì‘
- **í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ì •ë ¬:** Firestoreì˜ ë³µí•© ì¸ë±ìŠ¤ ìƒì„± ë¶€ë‹´ì„ ì¤„ì´ê¸° ìœ„í•´ ì„œë²„ ì¸¡ `orderBy`ë¥¼ ì œê±°í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ í›„ ì •ë ¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ì¸ë±ìŠ¤ ì—ëŸ¬ ë°œìƒ ì°¨ë‹¨.
- **ì¹´í…Œê³ ë¦¬ ë¶ˆì¼ì¹˜ ìˆ˜ì •:** ì•„ì´í…œ ë“±ë¡(`AddItemScreen`)ê³¼ ëª©ë¡ ì¡°íšŒ(`XinChaoDanggnScreen`) ê°„ì˜ ì¹´í…Œê³ ë¦¬ í…ìŠ¤íŠ¸ ë¶ˆì¼ì¹˜ ë¬¸ì œ í•´ê²°.

## 2. í˜„ì¬ ì§„í–‰ ì¤‘ì¸ í•µì‹¬ ì´ìŠˆ: êµ¬ê¸€ ë¡œê·¸ì¸ ì‹¤íŒ¨

### 2.1 ì¦ìƒ ë° ì—ëŸ¬ ë©”ì‹œì§€
- **ì—ëŸ¬ ë‚´ìš©:** `Error 400: invalid_request`, `Custom scheme URIs are not allowed for 'WEB' client type`.
- **ìƒí™©:** êµ¬ê¸€ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ ì‹œ ê³„ì • ì„ íƒ ì°½ìœ¼ë¡œ ë„˜ì–´ê°€ì§€ ëª»í•˜ê³  ì…êµ¬ì—ì„œ ì°¨ë‹¨ë¨. (ì´ì „ì—ëŠ” ê³„ì • ì„ íƒê¹Œì§€ëŠ” ë˜ì—ˆìœ¼ë‚˜ ëŒì•„ì˜¤ëŠ” ê¸¸ì— `Something went wrong` ë°œìƒ)

### 2.2 ì‹œë„ëœ ì¡°ì¹˜ ë° ë¶„ì„
- **clientId ì„¤ì •:** ì›¹ í´ë¼ì´ì–¸íŠ¸ IDë¥¼ ì‚¬ìš©í•˜ì—¬ `useProxy: true` í™˜ê²½ì—ì„œ HTTPS ë¦¬ë””ë ‰ì…˜ì„ ì‹œë„í•¨.
- **ì›ì¸ ì¶”ì •:** í˜„ì¬ ì•±ì´ **'ê°œë°œ ë¹Œë“œ(Development Build)'** í™˜ê²½ì—ì„œ ì‹¤í–‰ ì¤‘ì´ë©°, `AuthSession`ì´ ìƒì„±í•˜ëŠ” `redirect_uri`ê°€ êµ¬ê¸€ ì›¹ í´ë¼ì´ì–¸íŠ¸ê°€ í—ˆìš©í•˜ì§€ ì•ŠëŠ” ì»¤ìŠ¤í…€ ìŠ¤í‚¤ë§ˆ(`exp+...` ë˜ëŠ” `com.yourname...`)ë¡œ ìƒì„±ë˜ê³  ìˆìŒ.
- **ì‹¤íŒ¨í•œ ì‹œë„ë“¤:**
    - `makeRedirectUri`ë¥¼ ì´ìš©í•´ ìˆ˜ë™ìœ¼ë¡œ ì£¼ì†Œë¥¼ ê³ ì •í•˜ë ¤ í–ˆìœ¼ë‚˜ ì‹¤íŒ¨.
    - `app.json`ì— `owner` ì •ë³´ë¥¼ ì¶”ê°€í•˜ì—¬ Expo í”„ë¡ì‹œ ì„œë²„ì™€ì˜ ì •ì²´ì„± ì¼ì¹˜ë¥¼ ì‹œë„í–ˆìœ¼ë‚˜ íš¨ê³¼ ì—†ìŒ.
    - `responseType`ì„ `token`ê³¼ `id_token`ìœ¼ë¡œ ë²ˆê°ˆì•„ ì‹œë„í•¨.

### 2.3 ì°¨ê¸° ì‘ì—…ìë¥¼ ìœ„í•œ ê¶Œì¥ ì‚¬í•­
1. **Redirect URI ê°•ì œ í™•ì¸:** `promptAsync` ì‹¤í–‰ ì§ì „ `request.redirectUri` ê°’ì´ ì •í™•íˆ `https://auth.expo.io/@young146/chao-vn-app`ìœ¼ë¡œ ë‚˜ì˜¤ëŠ”ì§€ ë¡œê·¸ í™•ì¸ í•„ìˆ˜.
2. **êµ¬ê¸€ ì½˜ì†” ì¬ì„¤ì •:** ì›¹ í´ë¼ì´ì–¸íŠ¸ IDì˜ 'ìŠ¹ì¸ëœ ë¦¬ë””ë ‰ì…˜ URI'ì— ìœ„ ì£¼ì†Œê°€ ì •í™•íˆ ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸.
3. **ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ ê²€í† :** ê°œë°œ ë¹Œë“œì—ì„œëŠ” `expo-auth-session`ì´ ì•„ë‹Œ `react-native-google-signin` ê°™ì€ ìˆœìˆ˜ ë„¤ì´í‹°ë¸Œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë„ì…ì„ ê³ ë ¤í•´ì•¼ í•  ìˆ˜ë„ ìˆìŒ (í˜„ì¬ Expo í”„ë¡ì‹œ ë°©ì‹ì´ ê°œë°œ ë¹Œë“œì™€ ì¶©ëŒ ê°€ëŠ¥ì„± ë†’ìŒ).

## 3. 2025ë…„ 1ì›” 4ì¼ ì‘ì—… ë‚´ì—­ ë° âš ï¸ ì‹¬ê°í•œ ë¬¸ì œ ë°œìƒ

### 3.1 ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œëœ ìµœì í™”

#### ì•± ë¡œë”© ì†ë„ íšê¸°ì  ê°œì„ 
- **ì´ì „:** ì•± ë¡œë”©ì— ì•½ 10ì´ˆ ì´ìƒ ì†Œìš”
- **ì¡°ì¹˜:** 
  - `services/wordpressApi.js`ì— `getHomeDataCached()` í•¨ìˆ˜ ì¶”ê°€
  - 10ê°œì˜ ìˆœì°¨ API í˜¸ì¶œì„ 1ê°œì˜ ë³‘ë ¬ í˜¸ì¶œë¡œ í†µí•©
  - AsyncStorage ìºì‹œ + Stale-While-Revalidate ì „ëµ ì ìš©
  - `App.js`ì—ì„œ ìºì‹œ ìš°ì„  ë¡œë”© êµ¬í˜„
- **ê²°ê³¼:** 
  - ì²« ì‹¤í–‰: ~3.5ì´ˆ
  - ì¬ì‹¤í–‰(ìºì‹œ): 0.013ì´ˆ (ì¦‰ì‹œ ì§„ì…)

#### êµ¬ê¸€ ë¡œê·¸ì¸ ì†ë„ ê°œì„ 
- **ì´ì „:** ê³„ì • ì„ íƒ í›„ ë¡œê·¸ì¸ê¹Œì§€ ì•½ 15ì´ˆ ì†Œìš”
- **ì¡°ì¹˜:**
  - `AuthContext.js`ì—ì„œ í‘¸ì‹œ í† í° ë“±ë¡ì„ ë°±ê·¸ë¼ìš´ë“œë¡œ ì´ë™ (await ì œê±°)
  - Firestore setDoc ì‘ì—…ë“¤ì„ Promise.allë¡œ ë³‘ë ¬í™”
- **ê²°ê³¼:** ë¡œê·¸ì¸ ì‹œê°„ ì•½ 2-3ì´ˆë¡œ ë‹¨ì¶•

#### êµ¬ê¸€ ë¡œê·¸ì¸ ê³„ì • ì„ íƒ ê¸°ëŠ¥ ë³µì›
- `LoginScreen.js`ì—ì„œ `GoogleSignin.signOut()` ì¬í™œì„±í™”
- ë§¤ë²ˆ ë‹¤ë¥¸ ê³„ì • ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡ ìˆ˜ì •

### 3.2 âš ï¸ ì‹¬ê°í•œ ë¬¸ì œ: ì±„íŒ… ì•Œë¦¼ ì™„ì „ ë¶ˆëŠ¥

#### ë¬¸ì œ ìƒí™©
- **ì¦ìƒ:** ì±„íŒ… ì•Œë¦¼ì´ ì „í˜€ ì‘ë™í•˜ì§€ ì•ŠìŒ
  - ì•±ì´ ì—´ë ¤ìˆì„ ë•Œ: ì•Œë¦¼ ì•ˆ ì˜´
  - ì•±ì´ ë‹«í˜€ìˆì„ ë•Œ: ì•Œë¦¼ ì•ˆ ì˜´ (ì†Œë¦¬ë„, ë©”ì‹œì§€ë„ ì—†ìŒ)
- **ì›ì¸:** ë¶ˆëª…í™• - ë¡¤ë°± í›„ì—ë„ ë¬¸ì œ ì§€ì†

#### ì‹œë„í•œ ì¡°ì¹˜ë“¤ (ëª¨ë‘ ì‹¤íŒ¨)

1. **ì±„íŒ… ì „ì†¡ ì†ë„ ê°œì„  ì‹œë„ (ChatRoomScreen.js)**
   - ë‚™ê´€ì  ì—…ë°ì´íŠ¸(Optimistic Update) êµ¬í˜„ ì‹œë„
   - ê²°ê³¼: ë©”ì‹œì§€ì°½ ê¹œë¹¡ì„, ì•ŒëŒ ì™„ì „ ì¤‘ë‹¨
   - **ë¡¤ë°± ì™„ë£Œ:** commit 5dc6056ìœ¼ë¡œ ë³µì›

2. **Firebase Functions ìˆ˜ì • (functions/index.js)**
   - FCM í˜ì´ë¡œë“œì—ì„œ channelId, icon ë“± ìˆ˜ì • ì‹œë„
   - ê²°ê³¼: íš¨ê³¼ ì—†ìŒ
   - **ë¡¤ë°± ì™„ë£Œ:** commit 5dc6056ìœ¼ë¡œ ë³µì›

3. **AuthContext.js ìˆ˜ì •**
   - í‘¸ì‹œ í† í° ë“±ë¡ ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬
   - ê²°ê³¼: ë¡œê·¸ì¸ì€ ë¹¨ë¼ì¡Œìœ¼ë‚˜ ì•Œë¦¼ ë¬¸ì œì™€ ì—°ê´€ ê°€ëŠ¥ì„±
   - **ë¡¤ë°± ì™„ë£Œ:** commit 5dc6056ìœ¼ë¡œ ë³µì›

4. **App.js ì•Œë¦¼ ì±„ë„ ëª…ì‹œì  ìƒì„±**
   - `setupNotificationChannels()` í•¨ìˆ˜ ì¶”ê°€í•˜ì—¬ ì•± ì‹œì‘ ì‹œ chat ì±„ë„ ìƒì„±
   - ê²°ê³¼: íš¨ê³¼ ì—†ìŒ

#### í˜„ì¬ ìƒíƒœ (2025ë…„ 1ì›” 4ì¼)

| íŒŒì¼ | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| `AuthContext.js` | âœ… ì¶œì‹œ ë²„ì „ ë™ì¼ | git diff í™•ì¸ ì™„ë£Œ |
| `ChatRoomScreen.js` | âœ… ì¶œì‹œ ë²„ì „ ë™ì¼ | git diff í™•ì¸ ì™„ë£Œ |
| `functions/index.js` | âœ… ì¶œì‹œ ë²„ì „ ë™ì¼ | git diff í™•ì¸ ì™„ë£Œ |
| `App.js` | âš ï¸ ìˆ˜ì •ë¨ | ë¡œë”© ìµœì í™” + ì•Œë¦¼ ì±„ë„ ì½”ë“œ ì¶”ê°€ |
| `wordpressApi.js` | âš ï¸ ìˆ˜ì •ë¨ | ìºì‹± ìµœì í™” ì½”ë“œ ì¶”ê°€ |
| `LoginScreen.js` | âš ï¸ ìˆ˜ì •ë¨ | êµ¬ê¸€ ë¡œê·¸ì¸ signOut() ë³µì› |

#### ë¡œê·¸ ìƒíƒœ (ì •ìƒìœ¼ë¡œ ë³´ì„)
```
âœ… ì•Œë¦¼ ì±„ë„ ìƒì„± ì™„ë£Œ!
ğŸ“² Expo Push Token: ExponentPushToken[UnukgbJB3-aGQUOMqGGCjc]
ğŸ”¥ FCM/APNS Device Token: eX6i5bpIQTKoafzVjFsvVO:APA91bH...
âœ… í‘¸ì‹œ í† í° ì €ì¥ ì™„ë£Œ
```

#### ğŸš¨ êµí›ˆ: "ë¹ˆëŒ€ í•˜ë‚˜ ì¡ìœ¼ë ¤ë‹¤ ì§‘ì„ íƒœì› ë‹¤"
- ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡ ì†ë„ ê°œì„ ì„ ì‹œë„í•˜ë‹¤ê°€ ì•Œë¦¼ ì‹œìŠ¤í…œ ì „ì²´ê°€ ë§ê°€ì§
- ì›ì¸ íŒŒì•… ë¶ˆê°€ - ë¡¤ë°±í•´ë„ ë³µêµ¬ ì•ˆë¨
- ì¶œì‹œëœ ì•±ì—ì„œëŠ” ì •ìƒ ì‘ë™í•˜ë¯€ë¡œ ê°œë°œ ë¹Œë“œ í™˜ê²½ ë¬¸ì œì¼ ê°€ëŠ¥ì„± ìˆìŒ

### 3.3 ì°¨ê¸° ì‘ì—…ìë¥¼ ìœ„í•œ ê¶Œì¥ ì‚¬í•­

1. **ì ˆëŒ€ í•¨ë¶€ë¡œ ìˆ˜ì •í•˜ì§€ ë§ ê²ƒ** - ì•Œë¦¼ ê´€ë ¨ ì½”ë“œëŠ” ë¯¼ê°í•¨
2. **ì¶œì‹œ ì•±ê³¼ ê°œë°œ ì•± ë¹„êµ í…ŒìŠ¤íŠ¸** - ê°™ì€ ì½”ë“œì¸ë° ë‹¤ë¥´ê²Œ ë™ì‘í•  ìˆ˜ ìˆìŒ
3. **Firebase Functions ë¡œê·¸ í™•ì¸** - Consoleì—ì„œ ì‹¤ì œ ì „ì†¡ ì„±ê³µ/ì‹¤íŒ¨ í™•ì¸ í•„ìš”
4. **ìˆ˜ì‹ ì ê¸°ê¸°ì˜ í† í° ê°±ì‹ ** - ê°œë°œ ë¹Œë“œì—ì„œ í† í°ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ
5. **ì™„ì „ ë¡¤ë°± ê³ ë ¤** - App.js, wordpressApi.jsë„ ì¶œì‹œ ë²„ì „ìœ¼ë¡œ ë³µì› í›„ í…ŒìŠ¤íŠ¸

### 3.4 ì•ŒëŒ ë¶ˆì•ˆì • ì›ì¸ ë¶„ì„ (2025ë…„ 1ì›” 4ì¼ ì˜¤í›„)

#### ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼
| ë°©í–¥ | ê²°ê³¼ |
|------|------|
| ì¶œì‹œ ì•± â†’ ê°œë°œ ì•± | âœ… ì•ŒëŒ ì •ìƒ |
| ê°œë°œ ì•± â†’ ì¶œì‹œ ì•± | âŒ ì•ŒëŒ ë¶ˆì•ˆì • (ëë‹¤ê°€ ì•ˆ ëë‹¤ê°€) |
| ì¶œì‹œ ì•± â†” ì¶œì‹œ ì•± | âœ… ì™„ì „ ì •ìƒ |

#### ğŸ¯ í•µì‹¬ ì›ì¸: FCM í† í° ì¶©ëŒ

**Firestoreì— ì‚¬ìš©ìë‹¹ í•˜ë‚˜ì˜ FCM í† í°ë§Œ ì €ì¥ë¨:**
```javascript
// AuthContext.js
await setDoc(doc(db, "users", userId), {
  fcmToken: tokens.fcmToken,  // â† í•˜ë‚˜ë§Œ ì €ì¥ (ë®ì–´ì”Œì›€)
}, { merge: true });
```

**ë¬¸ì œ ì‹œë‚˜ë¦¬ì˜¤:**
1. ì‚¬ìš©ì Aê°€ **ì¶œì‹œ ì•±** ë¡œê·¸ì¸ â†’ ì¶œì‹œ ì•± í† í° ì €ì¥
2. ì‚¬ìš©ì Aê°€ **ê°œë°œ ì•±**ë„ ë¡œê·¸ì¸ â†’ ê°œë°œ ì•± í† í°ìœ¼ë¡œ **ë®ì–´ì”Œì›€**
3. ë©”ì‹œì§€ ìˆ˜ì‹  ì‹œ â†’ **ê°œë°œ ì•±ì—ë§Œ** ì•Œë¦¼ ê° (ì¶œì‹œ ì•±ì€ ëª» ë°›ìŒ)
4. ì¶œì‹œ ì•± ì¬ì‹œì‘ â†’ ì¶œì‹œ ì•± í† í°ìœ¼ë¡œ ë‹¤ì‹œ ë®ì–´ì”Œì›€
5. ì´ì œ **ì¶œì‹œ ì•±ì—ë§Œ** ì•Œë¦¼ ê°

**ê²°ë¡ :** ë§ˆì§€ë§‰ìœ¼ë¡œ ì•±ì„ ì‹œì‘í•œ ìª½ì—ë§Œ ì•Œë¦¼ì´ ê°

#### âš ï¸ ê°œë°œ ë¹Œë“œ íŠ¹ìœ ì˜ ë¬¸ì œë“¤

1. **Firestore WebChannel ì—°ê²° ë¶ˆì•ˆì •**
   ```
   @firebase/firestore: WebChannelConnection RPC 'Listen' stream transport errored
   ```
   - ê°œë°œ ë¹Œë“œì—ì„œ ì—°ê²°ì´ ìì£¼ ëŠê¹€
   - ì¬ì—°ê²° ì‹œ 50ê°œ ë©”ì‹œì§€ ì¼ê´„ ìˆ˜ì‹  â†’ í™”ë©´ í”ë“¤ë¦¼

2. **ë©”ì‹œì§€ ì „ì†¡ ì†ë„ ëŠë¦¼**
   - ì „ì†¡ ë²„íŠ¼ â†’ Firestore ì €ì¥ â†’ ì…ë ¥ì°½ ì´ˆê¸°í™”ê°€ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰
   - ê°œì„  ì‹œë„í–ˆìœ¼ë‚˜ ì•ŒëŒì— ì˜í–¥ ì¤„ ìˆ˜ ìˆì–´ ë¡¤ë°±í•¨

3. **ì¶œì‹œ ì•±ê³¼ ê°œë°œ ì•±ì˜ FCM í† í°ì´ ë‹¤ë¦„**
   - ê°™ì€ ì‚¬ìš©ìê°€ ë‘ ì•±ì— ë¡œê·¸ì¸í•˜ë©´ í† í° ì¶©ëŒ ë°œìƒ

#### ğŸ’¡ ê·¼ë³¸ í•´ê²°ì±… (í–¥í›„ ì‘ì—…)

**ë‹¤ì¤‘ ê¸°ê¸° ì•Œë¦¼ ì§€ì› í•„ìš”:**
- Firestoreì— FCM í† í°ì„ **ë°°ì—´**ë¡œ ì €ì¥
- Firebase Functionsì—ì„œ **ëª¨ë“  í† í°**ì— ì•Œë¦¼ ì „ì†¡
- ë°œì‹  ê¸°ê¸° í† í°ì€ ì œì™¸

```javascript
// ì˜ˆì‹œ: ë‹¤ì¤‘ í† í° ì €ì¥ êµ¬ì¡°
{
  fcmTokens: [
    { token: "xxx", platform: "android", deviceId: "device1" },
    { token: "yyy", platform: "android", deviceId: "device2" }
  ]
}
```

**âš ï¸ ì£¼ì˜:** ì´ ìˆ˜ì •ì€ ì‹œìŠ¤í…œ ì„¤ê³„ ë³€ê²½ì´ë¯€ë¡œ ì‹ ì¤‘í•˜ê²Œ ì§„í–‰í•´ì•¼ í•¨

## 4. í˜„ì¬ ìƒí™© ìš”ì•½

### âœ… ì™„ë£Œëœ ì‘ì—…
- [x] **ì•± ë¡œë”© ì†ë„ ìµœì í™”** - 10ì´ˆ â†’ 0.013ì´ˆ (ìºì‹œ)
- [x] **êµ¬ê¸€ ë¡œê·¸ì¸ ì†ë„ ê°œì„ ** - 15ì´ˆ â†’ 2-3ì´ˆ
- [x] **êµ¬ê¸€ ë¡œê·¸ì¸ ê³„ì • ì„ íƒ** - signOut() ë³µì›

### âš ï¸ ê°œë°œ ë¹Œë“œ íŠ¹ìœ  ë¬¸ì œ (ì¶œì‹œ ì•±ì—ì„œëŠ” ì •ìƒ)
- [ ] ì•ŒëŒ ë¶ˆì•ˆì • - FCM í† í° ì¶©ëŒ ë¬¸ì œ
- [ ] í™”ë©´ í”ë“¤ë¦¼ - Firestore WebChannel ë¶ˆì•ˆì •
- [ ] ì „ì†¡ ì†ë„ ëŠë¦¼ - ìˆœì°¨ì  await êµ¬ì¡°

### ğŸ“Œ ì¶œì‹œ ì „ í•„ìˆ˜ í™•ì¸
- Native ë¹Œë“œë¡œ ì¶œì‹œ ì‹œ, ê¸°ì¡´ ì¶œì‹œ ì•±(Expo Go)ê³¼ ë™ì¼í•˜ê²Œ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸ í•„ìš”
- **í…ŒìŠ¤íŠ¸ ë°©ë²•:** Native ë¹Œë“œ ì•±ë§Œ ë‹¨ë…ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ (ê°œë°œ ì•±ê³¼ ë™ì‹œ ì‚¬ìš© ê¸ˆì§€)

---

## 5. 2026ë…„ 1ì›” 8ì¼ ì‘ì—… ë‚´ì—­ - UI/UX ëŒ€ê·œëª¨ ê°œì„ 

### 5.1 ë©”ë‰´ ë° ë¸Œëœë”© ë³€ê²½

#### ë©”ë‰´ ì´ë¦„ ë³€ê²½
- **ì´ì „:** ì”¬ì§œì˜¤ë‹¹ê·¼
- **ë³€ê²½:** ì”¬ì§œì˜¤ë‚˜ëˆ”
- **ì ìš© ë²”ìœ„:** 
  - í•˜ë‹¨ íƒ­ ë©”ë‰´
  - ìŠ¤í¬ë¦° íƒ€ì´í‹€
  - ë”ë³´ê¸° ë©”ë‰´ ë²„ì „ ì •ë³´
  - ì•Œë¦¼ ì„¤ì • í™”ë©´

#### ë©”ì¸ ë©”ë‰´ í°íŠ¸ ê°•í™”
- `tabBarLabelStyle` ìˆ˜ì •
  - fontSize: 10 â†’ **12**
  - fontWeight: ê¸°ë³¸ â†’ **"700"**
  - tabBarInactiveTintColor: #999 â†’ **#666**

### 5.2 ë‚˜ëˆ”(ë‹¹ê·¼) ì¹´ë“œ UI ê°œì„ 

#### ì´ë¯¸ì§€ í¬ê¸° í™•ëŒ€
- **ì´ì „:** 140px
- **ë³€ê²½:** **210px** (1.5ë°°)

#### ì§€ì—­ í‘œì‹œ ê°œì„ 
- **ì´ì „:** í•œ ì¤„ (ì‹œ Â· êµ¬)
- **ë³€ê²½:** **ë‘ ì¤„** (ì‹œ Â· êµ¬ + ì•„íŒŒíŠ¸ëª…)
- **ìŠ¤íƒ€ì¼:**
  - fontSize: 11 â†’ **13**
  - color: #999 â†’ **#333**
  - fontWeight: **"600"** ì¶”ê°€

#### ê²€ìƒ‰ Placeholder ë³€ê²½
- **ì´ì „:** "ë¬¼í’ˆ ê²€ìƒ‰..."
- **ë³€ê²½:** **"ë‚´ ì•„íŒŒíŠ¸ ë‚˜ëˆ”ì„ ì°¾ì•„ë³´ì„¸ìš”"**

### 5.3 ì§€ì—­ ë°ì´í„° ê°„ì†Œí™” (vietnamLocations.js)

#### í˜¸ì¹˜ë¯¼ ìˆ«ì ì§€ì—­
- **ì´ì „:** "District 7 (Quáº­n 7)"
- **ë³€ê²½:** **"Q7"**

#### ê¸°íƒ€ ì§€ì—­ (í•œê¸€ ë°œìŒ ì œê±°)
- **ì´ì „:** "BÃ¬nh Tháº¡nh (ë¹ˆíƒ„)"
- **ë³€ê²½:** **"BÃ¬nh Tháº¡nh"**

#### Firebase ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
- ê¸°ì¡´ ë°ì´í„° ìˆ˜ë™ ìˆ˜ì • ì™„ë£Œ
- `scripts/migrate-districts.js` ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€

### 5.4 ìƒí’ˆ ë“±ë¡ í™”ë©´ ê°œì„  (AddItemScreen.js)

#### ì•„íŒŒíŠ¸ ì„ íƒ ì•ˆë‚´ ì¶”ê°€
- **í—¬í¼ í…ìŠ¤íŠ¸:** "ğŸ’¡ ì•„íŒŒíŠ¸ëª…ì„ ì„ íƒí•˜ë©´ ê°™ì€ ì•„íŒŒíŠ¸ ì£¼ë¯¼ì—ê²Œ ì•Œë¦¼ì´ ê°‘ë‹ˆë‹¤!"
- **Placeholder:** "ì„ íƒí•˜ì„¸ìš”" â†’ **"ğŸ  ì•„íŒŒíŠ¸ë¥¼ ì„ íƒí•˜ì„¸ìš”"**

### 5.5 ìƒì„¸ í˜ì´ì§€ ì§€ì—­ í‘œì‹œ ê°œì„  (ItemDetailScreen.js)

- **ì´ì „:** ì‹œ, êµ¬, ì•„íŒŒíŠ¸ ê°ê° ë³„ë„ Text
- **ë³€ê²½:** **"ğŸ“ í˜¸ì¹˜ë¯¼ Â· Q7 Â· ì•„íŒŒíŠ¸ëª…"** í•œ ì¤„ë¡œ í†µí•©
- **ìŠ¤íƒ€ì¼:** fontSize: 16, fontWeight: "600", color: "#222"

### 5.6 ë‰´ìŠ¤ í™”ë©´ ê°œì„  (MagazineScreen.js)

#### ì¹´í…Œê³ ë¦¬/ì¶œì²˜ í‘œì‹œ
- **ì´ì „:** "ë‰´ìŠ¤" ê³ ì • ë°°ì§€
- **ë³€ê²½:** **"ê²½ì œ / VnExpress"** í˜•ì‹
- **ì¶œì²˜ ìë™ ê°ì§€:** VnExpress, Thanh NiÃªn, Tuá»•i Tráº», Zing, VietnamNet, DÃ¢n TrÃ­, VOV ë“±

#### ì˜¤ëŠ˜ ë‚ ì§œ ë‰´ìŠ¤ë§Œ í‘œì‹œ
- **ì´ì „:** ë¬´í•œ ìŠ¤í¬ë¡¤ (ê³¼ê±° ë‰´ìŠ¤ê¹Œì§€ ê³„ì† ë¡œë”©)
- **ë³€ê²½:** **ì˜¤ëŠ˜ ë‚ ì§œ ë‰´ìŠ¤ë§Œ** ìë™ í•„í„°ë§

#### ë§ˆì§€ë§‰ ë©˜íŠ¸ ì¶”ê°€
- ì˜¤ëŠ˜ ë‰´ìŠ¤ ëë‚˜ë©´ í‘œì‹œ:
  ```
  âœ¨ ì´ìƒ, ì”¬ì§œì˜¤ë² íŠ¸ë‚¨ì—ì„œ ë½‘ì€ ì˜¤ëŠ˜ì˜ ë² íŠ¸ë‚¨ ë‰´ìŠ¤ì…ë‹ˆë‹¤ âœ¨
  ì§€ë‚œ ë‰´ìŠ¤ëŠ” ìƒë‹¨ì˜ 'ë‚ ì§œë³„ ë‰´ìŠ¤ ë³´ê¸°'ë¥¼ ì´ìš©í•´ì£¼ì„¸ìš”
  ```

### 5.7 ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ì£¼ìš” ë³€ê²½ |
|------|----------|
| `App.js` | íƒ­ ë©”ë‰´ëª… ë³€ê²½, í°íŠ¸ ìŠ¤íƒ€ì¼ ê°•í™” |
| `screens/XinChaoDanggnScreen.js` | ì¹´ë“œ UI, ê²€ìƒ‰ placeholder |
| `screens/ItemDetailScreen.js` | ì§€ì—­ í‘œì‹œ í†µí•© |
| `screens/AddItemScreen.js` | ì•„íŒŒíŠ¸ ì„ íƒ ì•ˆë‚´ |
| `screens/MagazineScreen.js` | ì¹´í…Œê³ ë¦¬/ì¶œì²˜, ì˜¤ëŠ˜ ë‰´ìŠ¤ í•„í„° |
| `screens/MoreScreen.js` | ë²„ì „ ì •ë³´ |
| `screens/NotificationSettingScreen.js` | ì•Œë¦¼ ì œëª© |
| `utils/vietnamLocations.js` | ì§€ì—­ëª… ê°„ì†Œí™” |
| `scripts/migrate-districts.js` | ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ (ì‹ ê·œ) |

---

## 6. 2026ë…„ 1ì›” 12ì¼ ì—…ë°ì´íŠ¸

### 6.1 AdMob ê´‘ê³  í†µí•©

#### íŒ¨í‚¤ì§€ ì„¤ì¹˜
- `react-native-google-mobile-ads` - AdMob SDK
- `@react-native-firebase/app` - Firebase ê¸°ë³¸
- `@react-native-firebase/remote-config` - ìì²´/êµ¬ê¸€ ê´‘ê³  ì „í™˜ ì œì–´

#### AdMob ì„¤ì •
| í”Œë«í¼ | App ID | Banner Ad Unit ID |
|--------|--------|-------------------|
| Android | `ca-app-pub-7944314901202352~3025832510` | `ca-app-pub-7944314901202352/4705993110` |
| iOS | `ca-app-pub-7944314901202352~9182981091` | `ca-app-pub-7944314901202352/7518491734` |

#### ê´‘ê³  ë°°ì¹˜ ìœ„ì¹˜
| í™”ë©´ | ìœ„ì¹˜ | ê´‘ê³  íƒ€ì… |
|------|------|----------|
| í™ˆ | ë¦¬ìŠ¤íŠ¸ ìµœìƒë‹¨ | `AdBanner` |
| í™ˆ | ê° ì„¹ì…˜ ì œëª© ìœ„ | `SectionAdBanner` |
| ë‰´ìŠ¤/ê²Œì‹œíŒ | ë¦¬ìŠ¤íŠ¸ ìµœìƒë‹¨ | `AdBanner` |
| ë‰´ìŠ¤/ê²Œì‹œíŒ | 4ê°œ ê¸°ì‚¬ë§ˆë‹¤ | `InlineAdBanner` |
| ë‚˜ëˆ” | ë¦¬ìŠ¤íŠ¸ ìµœìƒë‹¨ | `AdBanner` |
| ë¬¼í’ˆ ìƒì„¸ | ì´ë¯¸ì§€ ì•„ë˜ | `AdBanner` |

#### Remote Config ì—°ë™
- Firebase Remote Config `show_in_house_ads` ë³€ìˆ˜ë¡œ ê´‘ê³  ì „í™˜ ê°€ëŠ¥
- `false` = AdMob ê´‘ê³  (ê¸°ë³¸)
- `true` = ìì²´ ê´‘ê³ 

### 6.2 í™ˆ í™”ë©´ ë¡œë”© ìµœì í™”

#### ë¬¸ì œ
- ì¹´í…Œê³ ë¦¬ API 9ë²ˆ ì¤‘ë³µ í˜¸ì¶œ
- í™ˆ í™”ë©´ ë¡œë”© 3~5ì´ˆ ì†Œìš”

#### í•´ê²°
- ì¹´í…Œê³ ë¦¬ ëª©ë¡ ìºì‹œ (`cachedCategories`)
- `getAllCategories()` í•¨ìˆ˜ë¡œ 1ë²ˆë§Œ í˜¸ì¶œ
- `getHomeDataCached()`ì—ì„œ ì§ì ‘ í˜¸ì¶œë¡œ ì¤‘ë³µ ì œê±°

#### ê²°ê³¼
- API í˜¸ì¶œ: 9ë²ˆ â†’ 1ë²ˆ (88% ê°ì†Œ)
- ë¡œë”© ì‹œê°„: 3~5ì´ˆ â†’ 1ì´ˆ ì´ë‚´

### 6.3 ê²€ìƒ‰ ë³µê·€ ê¸°ëŠ¥ ì¶”ê°€

#### ë¬¸ì œ
- ê²€ìƒ‰ í›„ í™ˆìœ¼ë¡œ ëŒì•„ê°€ëŠ” ë°©ë²• ì—†ìŒ
- í™ˆ íƒ­ ëˆŒëŸ¬ë„ ê²€ìƒ‰ ìƒíƒœ ìœ ì§€

#### í•´ê²°
- `SearchHeader`ì— `onClear`, `isSearching` prop ì¶”ê°€
- ê²€ìƒ‰ ì¤‘ì¼ ë•Œ ì£¼í™©ìƒ‰ X ë²„íŠ¼ í‘œì‹œ
- í™ˆ íƒ­ì— `listeners` ì¶”ê°€ - íƒ­ í´ë¦­ ì‹œ `resetSearch` ì „ë‹¬
- `resetSearch` useEffectë¡œ ê²€ìƒ‰ ì´ˆê¸°í™”

### 6.4 í•˜ë‹¨ íƒ­ë°” SafeArea ì ìš©

#### ë¬¸ì œ
- í•˜ë‹¨ íƒ­ì´ ì‹œìŠ¤í…œ ì˜ì—­(ì œìŠ¤ì²˜ ë°”)ì— ê°€ë ¤ì§

#### í•´ê²°
- `SafeAreaProvider`ë¡œ ì•± ì „ì²´ ê°ì‹¸ê¸°
- `useSafeAreaInsets()`ë¡œ ë””ë°”ì´ìŠ¤ë³„ ì•ˆì „ ì˜ì—­ ê°ì§€
- `tabBarStyle`ì— ë™ì  íŒ¨ë”© ì ìš©

### 6.5 ë”ë³´ê¸° ë²„íŠ¼ ìˆ˜ì •

#### ë¬¸ì œ
- í™ˆ ì„¹ì…˜ì˜ "ë”ë³´ê¸° >" ë²„íŠ¼ ì‘ë™ ì•ˆ í•¨

#### ì›ì¸
- `navigation.navigate('HomeStack', ...)` - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìŠ¤í¬ë¦° ì´ë¦„

#### í•´ê²°
- `navigation.navigate('í™ˆ', ...)` - ì˜¬ë°”ë¥¸ íƒ­ ìŠ¤í¬ë¦° ì´ë¦„ìœ¼ë¡œ ìˆ˜ì •

### 6.6 ë‰´ìŠ¤ ìƒì„¸ ì´ë¯¸ì§€ ì¤‘ë³µ ì œê±°

#### ë¬¸ì œ
- ë‰´ìŠ¤ ê¸°ì‚¬ ì—´ë©´ ê°™ì€ ì´ë¯¸ì§€ê°€ 2ë²ˆ í‘œì‹œ
- ì‘ì€ ì´ë¯¸ì§€ (featuredImage) + í° ì´ë¯¸ì§€ (ë³¸ë¬¸ HTML)

#### ì›ì¸
- ì›Œë“œí”„ë ˆìŠ¤ `content.rendered`ì— ëŒ€í‘œ ì´ë¯¸ì§€ í¬í•¨

#### í•´ê²°
- `PostDetailScreen.js`ì—ì„œ ë³¸ë¬¸ ì²« ë²ˆì§¸ `<img>` ë˜ëŠ” `<figure>` íƒœê·¸ ì œê±°
```javascript
contentHtml = contentHtml
  .replace(/^(\s*<p>\s*)?<figure[^>]*>[\s\S]*?<\/figure>(\s*<\/p>)?/i, '')
  .replace(/^(\s*<p>\s*)?<img[^>]*\/?>/i, '');
```

### 6.7 ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ì£¼ìš” ë³€ê²½ |
|------|----------|
| `App.js` | SafeAreaProvider, useSafeAreaInsets, í™ˆíƒ­ listeners |
| `app.json` | AdMob ì„¤ì •, iOS googleServicesFile |
| `package.json` | Firebase, AdMob íŒ¨í‚¤ì§€ ì¶”ê°€ |
| `services/wordpressApi.js` | ì¹´í…Œê³ ë¦¬ ìºì‹œ ìµœì í™” (getAllCategories) |
| `screens/MagazineScreen.js` | getHomeDataCached, ê²€ìƒ‰ ì·¨ì†Œ, resetSearch, ë”ë³´ê¸° ìˆ˜ì • |
| `screens/PostDetailScreen.js` | ì´ë¯¸ì§€ ì¤‘ë³µ ì œê±° |
| `screens/ItemDetailScreen.js` | AdBanner ì¶”ê°€ |
| `screens/XinChaoDanggnScreen.js` | AdBanner ì¶”ê°€ |
| `components/AdBanner.js` | ğŸ†• ê´‘ê³  ë°°ë„ˆ ì»´í¬ë„ŒíŠ¸ (ì‹ ê·œ) |
| `GoogleService-Info.plist` | ğŸ†• iOS Firebase ì„¤ì • (ì‹ ê·œ) |

---
**ìµœì¢… ì—…ë°ì´íŠ¸ ì¼ì:** 2026ë…„ 1ì›” 12ì¼
**ì‘ì—… ìƒíƒœ:** 
- âœ… ë¡œë”©/ë¡œê·¸ì¸ ìµœì í™” ì„±ê³µ
- âœ… UI/UX ëŒ€ê·œëª¨ ê°œì„  ì™„ë£Œ
- âœ… ì§€ì—­ëª… ê°„ì†Œí™” ë° Firebase ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ
- âœ… AdMob ê´‘ê³  í†µí•© ì™„ë£Œ
- âœ… í™ˆ í™”ë©´ ë¡œë”© ìµœì í™” ì™„ë£Œ (9ë²ˆâ†’1ë²ˆ API í˜¸ì¶œ)
- âœ… ê²€ìƒ‰ ë³µê·€ ê¸°ëŠ¥ ì¶”ê°€
- âœ… í•˜ë‹¨ íƒ­ë°” SafeArea ì ìš©
- âœ… ë”ë³´ê¸° ë²„íŠ¼ ìˆ˜ì •
- âœ… ë‰´ìŠ¤ ì´ë¯¸ì§€ ì¤‘ë³µ ì œê±°
- âš ï¸ ê°œë°œ ë¹Œë“œì—ì„œ ì•ŒëŒ ë¶ˆì•ˆì • (FCM í† í° ì¶©ëŒ - ì¶œì‹œ ì•±ê³¼ ë™ì‹œ í…ŒìŠ¤íŠ¸ ì‹œ ë°œìƒ)
- âœ… ì¶œì‹œ ì•±ì€ ì™„ì „ ì •ìƒ ì‘ë™
