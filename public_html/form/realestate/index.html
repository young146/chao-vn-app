<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>ì”¬ì§œì˜¤ ë¶€ë™ì‚° | ë“±ë¡</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Noto Sans KR', system-ui, sans-serif;
            background: #f5f5f5;
        }

        .header {
            background: linear-gradient(135deg, #2E7D32, #66BB6A);
            color: #fff;
            padding: 20px 16px 24px;
            text-align: center;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 700;
        }

        .header p {
            font-size: 13px;
            opacity: 0.9;
            margin-top: 4px;
        }

        .form-body {
            padding: 16px;
            max-width: 600px;
            margin: 0 auto;
        }

        .section {
            background: #fff;
            border-radius: 16px;
            padding: 18px 16px;
            margin-bottom: 12px;
            box-shadow: 0 1px 8px rgba(0, 0, 0, 0.06);
        }

        .section-title {
            font-size: 14px;
            font-weight: 700;
            color: #333;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .required {
            color: #2E7D32;
        }

        label {
            font-size: 13px;
            color: #666;
            display: block;
            margin-bottom: 6px;
            margin-top: 12px;
        }

        label:first-of-type {
            margin-top: 0;
        }

        input[type=text],
        input[type=number],
        input[type=tel],
        textarea,
        select {
            width: 100%;
            border: 1.5px solid #e8e8e8;
            border-radius: 10px;
            padding: 12px 14px;
            font-size: 15px;
            font-family: inherit;
            color: #222;
            background: #fafafa;
            outline: none;
            transition: border-color 0.2s;
        }

        input:focus,
        textarea:focus,
        select:focus {
            border-color: #2E7D32;
            background: #fff;
        }

        textarea {
            resize: none;
            height: 120px;
            line-height: 1.6;
        }

        /* ê±°ë˜ ìœ í˜• */
        .type-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .type-btn {
            border: 1.5px solid #e0e0e0;
            border-radius: 12px;
            padding: 12px 4px;
            background: #fff;
            cursor: pointer;
            text-align: center;
            transition: all 0.15s;
            font-size: 13px;
            color: #555;
        }

        .type-btn .t-icon {
            font-size: 22px;
            display: block;
            margin-bottom: 4px;
        }

        .type-btn.active {
            border-color: #2E7D32;
            background: #E8F5E9;
            color: #2E7D32;
            font-weight: 700;
        }

        /* ì´ë¯¸ì§€ */
        .image-upload-area {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .img-add-btn {
            width: 90px;
            height: 90px;
            border: 2px dashed #ddd;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #aaa;
            font-size: 12px;
            gap: 4px;
            background: #fafafa;
        }

        .img-add-btn .plus {
            font-size: 28px;
            line-height: 1;
        }

        .img-preview-wrap {
            position: relative;
            width: 90px;
            height: 90px;
            border-radius: 12px;
            overflow: hidden;
        }

        .img-preview-wrap img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .img-remove {
            position: absolute;
            top: 4px;
            right: 4px;
            background: rgba(0, 0, 0, 0.55);
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, #2E7D32, #66BB6A);
            color: #fff;
            border: none;
            border-radius: 14px;
            padding: 16px;
            font-size: 16px;
            font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            margin-top: 8px;
            margin-bottom: 32px;
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        #success-screen {
            display: none;
        }

        .success-card {
            background: #fff;
            border-radius: 20px;
            padding: 28px 20px;
            text-align: center;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.08);
            margin: 16px;
        }

        .success-icon {
            font-size: 52px;
            margin-bottom: 12px;
        }

        .success-title {
            font-size: 20px;
            font-weight: 700;
            color: #222;
        }

        .success-sub {
            font-size: 14px;
            color: #888;
            margin-top: 8px;
            line-height: 1.6;
        }

        .kakao-share-box {
            background: #FEE500;
            border-radius: 14px;
            padding: 16px;
            margin-top: 20px;
            text-align: left;
        }

        .kakao-share-label {
            font-size: 13px;
            font-weight: 700;
            color: #3C1E1E;
            margin-bottom: 8px;
        }

        .kakao-share-text {
            font-size: 13px;
            color: #3C1E1E;
            white-space: pre-wrap;
            line-height: 1.7;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            padding: 12px;
        }

        .copy-btn {
            width: 100%;
            background: #3C1E1E;
            color: #FEE500;
            border: none;
            border-radius: 10px;
            padding: 12px;
            font-size: 14px;
            font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            margin-top: 10px;
        }

        .share-kakao-btn {
            width: 100%;
            background: #FEE500;
            color: #3C1E1E;
            border: none;
            border-radius: 14px;
            padding: 18px;
            font-size: 18px;
            font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            margin-top: 16px;
            margin-bottom: 16px;
            box-shadow: 0 4px 12px rgba(254, 229, 0, 0.4);
        }

        .another-btn {
            width: 100%;
            background: #2E7D32;
            color: #fff;
            border: none;
            border-radius: 14px;
            padding: 14px;
            font-size: 15px;
            font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            margin-top: 12px;
        }

        .loading-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0.85);
            z-index: 100;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .loading-overlay.active {
            display: flex;
        }

        .spinner {
            width: 44px;
            height: 44px;
            border: 4px solid #C8E6C9;
            border-top-color: #2E7D32;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .back-link {
            display: block;
            text-align: center;
            color: #2E7D32;
            font-size: 14px;
            margin-bottom: 16px;
            text-decoration: none;
            padding: 8px;
        }

        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
    </style>
</head>

<body>
    <div class="loading-overlay" id="loading">
        <div class="spinner"></div>
        <div class="loading-text" id="loading-text">ì—…ë¡œë“œ ì¤‘...</div>
    </div>

    <div id="form-screen">
        <div class="header">
            <h1>ğŸ  ì”¬ì§œì˜¤ ë¶€ë™ì‚°</h1>
            <p>ì„ëŒ€ Â· ë§¤ë§¤ Â· ë‹¨ê¸°ìˆ™ì†Œ ë“±ë¡</p>
        </div>

        <div class="form-body">
            <a href="../" class="back-link">â† ì¹´í…Œê³ ë¦¬ ì„ íƒìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>

            <!-- ê±°ë˜ ìœ í˜• -->
            <div class="section">
                <div class="section-title">ğŸ˜ï¸ ê±°ë˜ ìœ í˜• <span class="required">*</span></div>
                <div class="type-grid">
                    <button class="type-btn active" data-val="ì„ëŒ€" onclick="selectType(this)">
                        <span class="t-icon">ğŸ”‘</span>ì„ëŒ€
                    </button>
                    <button class="type-btn" data-val="ë§¤ë§¤" onclick="selectType(this)">
                        <span class="t-icon">ğŸ¡</span>ë§¤ë§¤
                    </button>
                    <button class="type-btn" data-val="ë‹¨ê¸°ìˆ™ì†Œ" onclick="selectType(this)">
                        <span class="t-icon">ğŸ›ï¸</span>ë‹¨ê¸°ìˆ™ì†Œ
                    </button>
                    <button class="type-btn" data-val="ë£¸ë©”ì´íŠ¸" onclick="selectType(this)">
                        <span class="t-icon">ğŸ‘¥</span>ë£¸ë©”ì´íŠ¸
                    </button>
                    <button class="type-btn" data-val="ì‚¬ì—…ì¥" onclick="selectType(this)">
                        <span class="t-icon">ğŸ¢</span>ì‚¬ì—…ì¥
                    </button>
                    <button class="type-btn" data-val="ê¸°íƒ€" onclick="selectType(this)">
                        <span class="t-icon">ğŸ“¦</span>ê¸°íƒ€
                    </button>
                </div>
            </div>

            <!-- ì‚¬ì§„ -->
            <div class="section">
                <div class="section-title">ğŸ“· ì‚¬ì§„ (ìµœëŒ€ 5ì¥)</div>
                <div class="image-upload-area" id="img-area">
                    <div class="img-add-btn" onclick="document.getElementById('file-input').click()">
                        <span class="plus">+</span><span>ì‚¬ì§„ ì¶”ê°€</span>
                    </div>
                </div>
                <div style="font-size:12px;color:#888;margin-top:6px" id="img-count">0 / 5</div>
                <input type="file" id="file-input" accept="image/*" multiple style="display:none"
                    onchange="handleImages(this)">
            </div>

            <!-- ê¸°ë³¸ ì •ë³´ -->
            <div class="section">
                <div class="section-title">âœï¸ ê¸°ë³¸ ì •ë³´</div>
                <label>ì œëª© <span class="required">*</span></label>
                <input type="text" id="title" placeholder="ì˜ˆ: ë¹ˆí™ˆ ì”¨í‹° 2ë£¸ ì„ëŒ€í•©ë‹ˆë‹¤" maxlength="60">

                <div class="two-col" style="margin-top:12px">
                    <div>
                        <label>ê°€ê²© <span class="required">*</span></label>
                        <input type="text" id="price" placeholder="ì˜ˆ: ì›” 800ë§Œë™, í˜‘ì˜">
                    </div>
                    <div>
                        <label>ë©´ì  (mÂ²)</label>
                        <input type="number" id="area" placeholder="ì˜ˆ: 65" min="0">
                    </div>
                </div>

                <label>ë°© ìˆ˜ / ìš•ì‹¤ ìˆ˜</label>
                <input type="text" id="rooms" placeholder="ì˜ˆ: 2ë£¸ 1ìš•ì‹¤, ìŠ¤íŠœë””ì˜¤">

                <label>ìƒì„¸ ì„¤ëª… <span class="required">*</span></label>
                <textarea id="description" placeholder="ì¸µìˆ˜, ë°©í–¥, ê°€êµ¬ ìœ ë¬´, ì£¼ì°¨, ê´€ë¦¬ë¹„ ë“± ìì„¸íˆ ì ì–´ì£¼ì„¸ìš”"></textarea>
            </div>

            <!-- ìœ„ì¹˜ -->
            <div class="section">
                <div class="section-title">ğŸ“ ìœ„ì¹˜</div>
                <label>ë„ì‹œ <span class="required">*</span></label>
                <select id="city">
                    <option value="">ë„ì‹œ ì„ íƒ</option>
                    <option value="í˜¸ì¹˜ë¯¼">í˜¸ì¹˜ë¯¼</option>
                    <option value="í•˜ë…¸ì´">í•˜ë…¸ì´</option>
                    <option value="ë‹¤ë‚­">ë‹¤ë‚­</option>
                    <option value="ëƒì§±">ëƒì§±</option>
                    <option value="ë¶•ë”°ìš°">ë¶•ë”°ìš°</option>
                    <option value="ë¹ˆì¦">ë¹ˆì¦</option>
                    <option value="ë™ë‚˜ì´">ë™ë‚˜ì´</option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                </select>

                <label>êµ¬/êµ°</label>
                <input type="text" id="district" placeholder="ì˜ˆ: 7êµ°, ë¹ˆíƒ„êµ¬">

                <label>ì•„íŒŒíŠ¸/ê±´ë¬¼ëª…</label>
                <input type="text" id="apartment" placeholder="ì˜ˆ: ë¹ˆí™ˆ ì„¼íŠ¸ëŸ´íŒŒí¬, ë§ˆìŠ¤í…Œë¦¬">

                <label>ìƒì„¸ ì£¼ì†Œ</label>
                <input type="text" id="address" placeholder="ì˜ˆ: Aë™ 12ì¸µ (ì„ íƒì‚¬í•­)">
            </div>

            <!-- ì—°ë½ì²˜ -->
            <div class="section">
                <div class="section-title">ğŸ“ ì—°ë½ì²˜ <span class="required">*</span></div>
                <label>ì „í™”ë²ˆí˜¸</label>
                <input type="tel" id="phone" placeholder="010-1234-5678 ë˜ëŠ” +84-123-456-789">
                <label>ì¹´ì¹´ì˜¤í†¡ ID</label>
                <input type="text" id="kakao-id" placeholder="kakao_id123">
                <label>ê¸°íƒ€ (Zalo ë“±)</label>
                <input type="text" id="other-contact" placeholder="Zalo: 0123456789">
                <label>ì´ë¦„/ë‹‰ë„¤ì„</label>
                <input type="text" id="contact-name" placeholder="í™ê¸¸ë™ (ì„ íƒì‚¬í•­)">
            </div>

            <button class="submit-btn" id="submit-btn" onclick="submitForm()">
                âœ… ë“±ë¡í•˜ê¸°
            </button>
        </div>
    </div>

    <div id="success-screen">
        <div class="header" style="background: linear-gradient(135deg, #4CAF50, #66BB6A);">
            <h1>âœ… ë“±ë¡ ì™„ë£Œ!</h1>
            <p>ì”¬ì§œì˜¤ ì•±ì— ìë™ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤</p>
        </div>
        <div class="success-card">
            <div class="success-icon">ğŸ‰</div>
            <div class="success-title">ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!</div>
            <div class="success-sub">ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë°”ë¡œ ì˜¤í”ˆì±„íŒ…ì— ê³µìœ í•˜ì„¸ìš”!</div>
            <button class="share-kakao-btn" onclick="shareToKakao()">ğŸ’¬ ì¹´ì¹´ì˜¤í†¡ì— ê³µìœ í•˜ê¸°</button>
            <div class="kakao-share-box">
                <div class="kakao-share-label">ğŸ“‹ ê³µìœ  ë‚´ìš© ë¯¸ë¦¬ë³´ê¸°</div>
                <div class="kakao-share-text" id="share-text"></div>
                <button class="copy-btn" onclick="copyText()">ğŸ“‹ í…ìŠ¤íŠ¸ë§Œ ë³µì‚¬í•˜ê¸°</button>
            </div>
        </div>
        <button class="another-btn" onclick="location.reload()">+ ë˜ ë“±ë¡í•˜ê¸°</button>
        <hr style="margin: 16px 0; border-color: #f0f0f0;">
        <a href="../" style="display:block;text-align:center;color:#888;font-size:13px">â† ì²˜ìŒìœ¼ë¡œ</a>
    </div>
    </div>

    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.4/kakao.min.js"></script>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js';
        import { getFirestore, collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js';
        import { getStorage, ref, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-storage.js';
        import { getAuth, signInAnonymously } from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js';

        if (typeof Kakao !== 'undefined' && !Kakao.isInitialized()) {
            Kakao.init('eb4612604473e026e6cc7ed41ededbc3');
        }

        const app = initializeApp({
            apiKey: "AIzaSyAAtT9gcu8eVQIhQxYEgBTGp2XZ6ghz_NU",
            authDomain: "chaovietnam-login.firebaseapp.com",
            projectId: "chaovietnam-login",
            storageBucket: "chaovietnam-login.firebasestorage.app",
            messagingSenderId: "249390849714",
            appId: "1:249390849714:web:95ae3e7f066b70ffe973ab",
        });
        const db = getFirestore(app);
        const storage = getStorage(app);
        const auth = getAuth(app);

        let dealType = 'ì„ëŒ€';
        let imageFiles = [];

        window.selectType = (btn) => {
            document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            dealType = btn.dataset.val;
        };

        window.handleImages = (input) => {
            const files = Array.from(input.files);
            const toAdd = files.slice(0, 5 - imageFiles.length);
            imageFiles = [...imageFiles, ...toAdd];
            renderImages();
            input.value = '';
        };

        function renderImages() {
            const area = document.getElementById('img-area');
            area.innerHTML = '';
            imageFiles.forEach((f, i) => {
                const wrap = document.createElement('div');
                wrap.className = 'img-preview-wrap';
                const img = document.createElement('img');
                img.src = URL.createObjectURL(f);
                const btn = document.createElement('button');
                btn.className = 'img-remove';
                btn.innerHTML = 'Ã—';
                btn.onclick = () => { imageFiles.splice(i, 1); renderImages(); };
                wrap.appendChild(img); wrap.appendChild(btn);
                area.appendChild(wrap);
            });
            if (imageFiles.length < 5) {
                const addBtn = document.createElement('div');
                addBtn.className = 'img-add-btn';
                addBtn.innerHTML = '<span class="plus">+</span><span>ì‚¬ì§„ ì¶”ê°€</span>';
                addBtn.onclick = () => document.getElementById('file-input').click();
                area.appendChild(addBtn);
            }
            document.getElementById('img-count').textContent = `${imageFiles.length} / 5`;
        }

        async function uploadImage(file, uid) {
            const resized = await resizeImage(file, 800);
            const path = `realestate-web/${uid}_${Date.now()}_${Math.random().toString(36).slice(2)}.jpg`;
            await uploadBytes(ref(storage, path), resized);
            return await getDownloadURL(ref(storage, path));
        }

        function resizeImage(file, maxW) {
            return new Promise(resolve => {
                const img = new Image();
                img.onload = () => {
                    const ratio = Math.min(1, maxW / img.width);
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width * ratio; canvas.height = img.height * ratio;
                    canvas.getContext('2d').drawImage(img, 0, 0, canvas.width, canvas.height);
                    canvas.toBlob(resolve, 'image/jpeg', 0.8);
                };
                img.src = URL.createObjectURL(file);
            });
        }

        window.submitForm = async () => {
            const title = document.getElementById('title').value.trim();
            const price = document.getElementById('price').value.trim();
            const area = document.getElementById('area').value.trim();
            const rooms = document.getElementById('rooms').value.trim();
            const description = document.getElementById('description').value.trim();
            const city = document.getElementById('city').value;
            const district = document.getElementById('district').value.trim();
            const apartment = document.getElementById('apartment').value.trim();
            const address = document.getElementById('address').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const kakaoId = document.getElementById('kakao-id').value.trim();
            const otherContact = document.getElementById('other-contact').value.trim();
            const contactName = document.getElementById('contact-name').value.trim();

            if (!title) { alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
            if (!price) { alert('ê°€ê²©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
            if (!description) { alert('ìƒì„¸ ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
            if (!city) { alert('ë„ì‹œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
            if (!phone && !kakaoId && !otherContact) { alert('ì—°ë½ì²˜ë¥¼ ìµœì†Œ í•˜ë‚˜ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }

            document.getElementById('submit-btn').disabled = true;
            document.getElementById('loading').classList.add('active');

            try {
                const cred = await signInAnonymously(auth);
                const uid = cred.user.uid;

                let imageUrls = [];
                for (let i = 0; i < imageFiles.length; i++) {
                    document.getElementById('loading-text').textContent = `ì‚¬ì§„ ${i + 1}/${imageFiles.length} ì—…ë¡œë“œ ì¤‘...`;
                    imageUrls.push(await uploadImage(imageFiles[i], uid));
                }

                document.getElementById('loading-text').textContent = 'ë“±ë¡ ì¤‘...';
                const location = `${city} ${district} ${apartment} ${address}`.trim();
                const docRef = await addDoc(collection(db, 'RealEstate'), {
                    title, dealType, price, area: area || '',
                    rooms: rooms || '', description,
                    city, district, apartment, address, location,
                    images: imageUrls,
                    contact: { phone: phone || '', kakaoId: kakaoId || '', other: otherContact || '' },
                    userId: uid,
                    userEmail: 'kakaotalk-web@chaovietnam.co.kr',
                    userName: contactName || 'ì¹´ì¹´ì˜¤ ë“±ë¡',
                    source: 'kakaotalk-web',
                    status: 'ê±°ë˜ì¤‘',
                    createdAt: serverTimestamp(),
                });

                const typeEmoji = { 'ì„ëŒ€': 'ğŸ”‘', 'ë§¤ë§¤': 'ğŸ¡', 'ë‹¨ê¸°ìˆ™ì†Œ': 'ğŸ›ï¸', 'ë£¸ë©”ì´íŠ¸': 'ğŸ‘¥', 'ì‚¬ì—…ì¥': 'ğŸ¢', 'ê¸°íƒ€': 'ğŸ“¦' }[dealType] || 'ğŸ ';
                const contactText = [phone, kakaoId ? `ì¹´ì¹´ì˜¤: ${kakaoId}` : '', otherContact].filter(Boolean).join(' | ');
                const shareText = [
                    `${typeEmoji} [ë¶€ë™ì‚° ${dealType}] ${title}`,
                    `ğŸ’° ê°€ê²©: ${price}`,
                    area ? `ğŸ“ ë©´ì : ${area}mÂ²` : '',
                    rooms ? `ğŸšª êµ¬ì¡°: ${rooms}` : '',
                    `ğŸ“ ìœ„ì¹˜: ${city}${district ? ' ' + district : ''}${apartment ? ' ' + apartment : ''}`,
                    ``,
                    description.length > 200 ? description.slice(0, 200) + '...' : description,
                    ``,
                    `ğŸ“ ì—°ë½ì²˜: ${contactText}${contactName ? ' (' + contactName + ')' : ''}`,
                    `ğŸ”— ì”¬ì§œì˜¤ ì•± ë‹¤ìš´ë¡œë“œ â†’ https://play.google.com/store/apps/details?id=com.yourname.chaovnapp`,
                ].filter(Boolean).join('\n');

                document.getElementById('share-text').textContent = shareText;

                window.shareContent = {
                    id: docRef.id,
                    title: `${typeEmoji} [ë¶€ë™ì‚° ${dealType}] ${title}`,
                    description: `ğŸ’° ê°€ê²©: ${price}\n${area ? `ğŸ“ ë©´ì : ${area}mÂ²\n` : ''}ğŸ“ ìœ„ì¹˜: ${city}${district ? ' ' + district : ''}${apartment ? ' ' + apartment : ''}`,
                    imageUrl: imageUrls.length > 0 ? imageUrls[0] : 'https://chaovietnam-login.web.app/assets/icon.png'
                };
                document.getElementById('form-screen').style.display = 'none';
                document.getElementById('success-screen').style.display = 'block';
                window.scrollTo(0, 0);
            } catch (e) {
                alert('ë“±ë¡ ì˜¤ë¥˜: ' + e.message);
                document.getElementById('submit-btn').disabled = false;
            } finally {
                document.getElementById('loading').classList.remove('active');
            }
        };

        window.shareToKakao = function () {
            const content = window.shareContent;
            if (!content) return;

            if (typeof Kakao === 'undefined') {
                const text = document.getElementById('share-text').textContent;
                navigator.clipboard.writeText(text);
                alert('ì¹´ì¹´ì˜¤í†¡ ì‹œìŠ¤í…œ ì¼ì‹œ ì˜¤ë¥˜ì…ë‹ˆë‹¤. í…ìŠ¤íŠ¸ê°€ ëŒ€ì‹  ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.\nì¹´ì¹´ì˜¤í†¡ì— ê¸¸ê²Œ ëˆŒëŸ¬ ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”!');
                return;
            }

            Kakao.Share.sendDefault({
                objectType: 'feed',
                content: {
                    title: content.title,
                    description: content.description,
                    imageUrl: content.imageUrl,
                    link: {
                        mobileWebUrl: `https://chaovietnam-login.web.app/download.html?type=realestate&id=${content.id}`,
                        webUrl: `https://chaovietnam-login.web.app/download.html?type=realestate&id=${content.id}`,
                    },
                },
                buttons: [
                    {
                        title: 'ì•±ì—ì„œ ìì„¸íˆ ë³´ê¸°',
                        link: {
                            mobileWebUrl: `https://chaovietnam-login.web.app/download.html?type=realestate&id=${content.id}`,
                            webUrl: `https://chaovietnam-login.web.app/download.html?type=realestate&id=${content.id}`,
                        },
                    },
                ],
            });
        };

        window.copyText = () => {
            navigator.clipboard.writeText(document.getElementById('share-text').textContent).then(() => {
                const btn = document.querySelector('.copy-btn');
                btn.textContent = 'âœ… ë³µì‚¬ë¨!';
                setTimeout(() => { btn.textContent = 'ğŸ“‹ í…ìŠ¤íŠ¸ë§Œ ë³µì‚¬í•˜ê¸°'; }, 2000);
            });
        };
    </script>
</body>

</html>